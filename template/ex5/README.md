(テーマ)ファイルを読んでデコード
================================

実習に使うボードからとったデータをデコードするルーチンを書く。

データフォーマットはdoc/raw-data-packet-format.pdfにある。

ヘッダ部と、データ部にわかれている。
ヘッダ部の長さは12バイトで固定である。このなかに次に続くデータ部の
長さが書いてある(バイトを単位)。その他ヘッダには

* データタイプ(0xf) (他のデータパケットと見分けるのが目的)
* Word length (2) (1トリガ1チャンネル1ウインドウデータのバイトサイズ)
* # of Ch (16) (チャンネル数)
* データ長
* トリガーカウント (0が最初。トリガーがかかるごとに1づつ増える)

の情報が入っているのでこれを取り出す。複数バイトで構成される数値はいずれも
ネットワークバイトオーダになっているので、PCで扱うには変換が必要になる。

プログラムはtemplate/read_file_decodeにあるが、デコード部分のメソッドが
書いてないのでこれを埋めること。

できたデコードプログラムは最終的にDAQ-Middlewareコンポーネントに組み込むことになる。

サンプルデータはbs/sample.datにある。このファイルのデータ部をデコードして
trg: XXX ch: XXX window: XXX data: XXX
と並べたものをbs/ascii.sampleとしておいてあるので自分で書いたプログラムでOKか
どうかはこれと同じフォーマットで出力するようにして比較することで可能である。
比較にはたとえばdiffプログラムを使うと機械的にできる。

    diff -u file_a file_b

違いがなければなにも出力されない。

ファイル

* Makefile
* RawDataPacket.h     デコードルーチンクラスファイル
* RawDataPacket.cpp   デコードルーチンクラス実装(各メソッドが書いてないので埋める)
* read_file_decode.cpp fread()を使ってファイルを読む(このなかでRawDataPacketで実装したメソッドを使っている。main()はこのなかにある)。

実装するメソッド(ヘッダ部)

* is_raw_data_packet()
* get_word_size()
* get_data_length()
* get_num_of_ch()
* get_window_size()

get_window_size()はデータ長/(ワードサイズ*チャンネル数)で求めたwindow数を返すこと。

データ部

* get_data_at(int ch, int window)

データ部はwindowごとにまとまっていてひとつのチャンネルのデータが連続している
わけではない。デコードする際にはチャンネルごとのデータがほしいことが多いかと
思うので、引数にチャンネル番号、windowを指定することにした。
